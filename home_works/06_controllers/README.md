# Домашнее задание №6 к занятию по Rails Controllers

Необходимо написать метод `check` для `OrdersController`.

Входящие параметры: `cpu`, `ram`, `hdd_type`, `hdd_capacity`, `os`.

* `cpu`, `ram`, `hdd_capacity` - целые числа.
* `hdd_type` - возможные варианты `sata`, `sas`, `ssd`.
* `os` - возможные варианты `windows`, `linux`.

Требования:

1. Метод должен быть доступен только для аутентифицированных пользователей.

1. Метод должен получить список возможных конфигураций виртуальной машины из внешнего сервиса по адресу <http://possible_orders.srv.w55.ru/>. Пример доступной конфигурации:

    ```json
    {
      "os": ["linux"],
      "cpu": [1, 2, 4, 8, 16],
      "ram": [1, 2, 4, 8, 16, 32],
      "hdd_type": ["sata", "sas"],
      "hdd_capacity": {
        "sata": {
          "from": 10,
          "to": 100
        },
        "sas": {
          "from": 20,
          "to": 150
        },
      }
    }
    ```

1. Метод должен проверить соответствие переданных параметров одной из конфигураций полученной из внешнего сервиса.

1. Метод должен запросить цену у сервиса который вы написали в рамках [ДЗ 4 HTTP](./04_http/README.md). Добавьте его как сервис в docker-compose.yml проекта.

1. Метод должен проверить наличие достаточного количества средств на балансе пользователя.

1. Если все проверки прошли успешно, то метод должен вернуть статус 200 и json содержащий:

    * `result` - поле содержащее true
    * `total` - стоимость заказа
    * `balance` - текущий баланс пользователя
    * `balance_after_transaction` - баланс после проведения операции

1. Если одна из проверок не прошла, или обращение к внешним сервисам завершилось неудачно, то метод должен вернуть json содержащий:

    * `result` - поле содержащее false
    * `error` - текстовое поле содержащее описание проблемы

1. Статус ответа должен зависеть от причины ошибки:

    * `503 Service Unavailable` - если ошибка доступа к внешней системе
    * `406 Not Acceptable` - если используется некорректная конфигурация ВМ или недостаточно средств
    * `401 Unauthorized` - если в текущей сессии нет имени пользователя или баланса

Тестировать запрос можно через браузер так как в случае использования curl весьма затруднительно передавать идентификатор сессии.
